# PR0201

## 1. Permisos de usuarios
### 1.1 Para crear los directorios:
```bash
usuario@hugo:~$ mkdir pr0201
usuario@hugo:~$ ls
pr0201
usuario@hugo:~$ cd pr0201/
usuario@hugo:~/pr0201$ mkdir dir1
usuario@hugo:~/pr0201$ mkdir dir2
usuario@hugo:~/pr0201$ ls
dir1  dir2
usuario@hugo:~/pr0201$ ls -l
total 8
drwxrwxr-x 2 usuario usuario 4096 sep 26 08:07 dir1
drwxrwxr-x 2 usuario usuario 4096 sep 26 08:07 dir2
usuario@hugo:~/pr0201$

Tienen todos los permisos el usuario y el grupo y los demas solo pueden leer y ejecutar
```
### 1.2 eliminar permisos del dir2 con notacion simbolica:
```bash
usuario@hugo:~/pr0201$ chmod a-w dir2
usuario@hugo:~/pr0201$
 ```
### 1.3 eliminar permisos del dir2 con notacion octal:
```bash
usuario@hugo:~/pr0201$ chmod 771 dir2
usuario@hugo:~/pr0201$
```
### 1.4 permisos actuales del dir2:
```bash
usuario@hugo:~/pr0201$ ls -l
total 8
drwxrwxr-x 2 usuario usuario 4096 sep 26 08:07 dir1
drwxrwx--x 2 usuario usuario 4096 sep 26 08:07 dir2
usuario@hugo:~/pr0201$
```
El propietario y el grupo pueden leer, escribir y acceder al contenido del directorio, mientras que los demás usuarios solo tienen permiso de ejecución.

## 2. Notación octal y simbólica
### 2.1 Notación simbolica
```bash
rwxrwxr-x : chmod u+rwx,g+rwx,o+rx file
rwxr--r-- : chmod u+x,g-rw,o+r file
r--r----- : chmod u-w,g-rw,o-r file
rwxr-xr-x : chmod u+x,g+rx,o+x file
r-x--x--x : chmod u-w,g-r,o-rw,u+x,g+x,o+x file
-w-r----x : chmod u-wx,g+w,o+x,o-r file
-----xrwx : chmod u-rw,g-rw,o+rwx,g+x file
r---w---x : chmod u+r,g-w,o+x,g-r file
-w------- : chmod u-w,g-r,o-r file
rw-r----- : chmod u+rw,g+r,o-r file 
rwx--x--x : chmod u+x,g-x,o+x file
```
### 2.2 Notación octal
``` bash
rwxrwxrwx : chmod 777 file
--x--x--x : chmod 111 file
r---w---x : chmod 421 file
-w------- : chmod 200 file
rw-r----- : chmod 640 file
rwx--x--x : chmod 711 file
rwxr-xr-x : chmod 755 file
r-x--x--x : chmod 511 file
-w-r----x : chmod 241 file
-----xrwx : chmod 017 file
```
## 3 El bit setgid

### 3.1 Creacion de grupo y de usuarios
```bash
usuario@hugo:/$ sudo groupadd asir
usuario@hugo:/$ sudo useradd -g asir hgs1
usuario@hugo:/$ sudo useradd -g asir hgs2
```
### 3.2 Crear el directorio 
```bash
usuario@hugo:/$ sudo mkdir /compartido
usuario@hugo:/$ sudo chown root:asir /compartido
```
### 3.3 Asignar permisos al directorio
```bash
usuario@hugo:/$ sudo chmod 770 /compartido
usuario@hugo:/$ ls -l 
total 2097224
lrwxrwxrwx   1 root root          7 Aug 10  2023 bin -> usr/bin
drwxr-xr-x   4 root root       4096 Jan 11  2024 boot
drwxrwx---   2 root asir       4096 Oct  3 07:56 compartido
```
### 3.4 Establecer el bit setgid en el directorio
```bash
usuario@hugo:/$ sudo chmod g+s /compartido
usuario@hugo:/$ ls -ld compartido/
drwxrws--- 2 root asir 4096 Oct  3 07:56 compartido/
```
### 3.5
```bash
usuario@hugo:/$ su hgs1
Password:
$ cd compartido
$ touch fichero1
$ ls -l
total 0
-rw-r--r-- 1 hgs1 asir 0 Oct  7 10:12 fichero1
$ echo "hola" > fichero1
$ cat fichero1
hola
```
### 3.6
```bash
usuario@hugo:/$ su hgs2
Password:
$ cd compartido
$ cat fichero1
hola
$
```
### 3.7
¿Qué ventajas tiene usar el bit setgid en entornos colaborativos?


¿Qué sucede si no se aplica el bit setgid en un entorno colaborativo?

### 3.8
```bash
usuario@hugo:/$ sudo rm -r compartido
usuario@hugo:/$ sudo userdel  hgs1 
usuario@hugo:/$ sudo userdel  hgs2
```

## 4. El sticky bit
### 4.1 Crear directorio
```bash
usuario@hugo:/$ sudo mkdir /compartido
usuario@hugo:/$ sudo chmod 777 /compartido
usuario@hugo:/$ ls -ld /compartido/
drwxrwxrwx 2 root root 4096 Oct  7 10:53 /compartido/
```
### 4.2 Crear los usuarios
```bash
sudo adduser hgs2
Adding user `hgs2' ...
Adding new group `hgs2' (1003) ...
Adding new user `hgs2' (1002) with group `hgs2' ...
The home directory `/home/hgs2' already exists.  Not copying from `/etc/skel'.
adduser: Warning: The home directory `/home/hgs2' does not belong to the user you are currently creating.  
New password:
Retype new password:
passwd: password updated successfully
Changing the user information for hgs2
Enter the new value, or press ENTER for the default
        Full Name []:
        Room Number []:
        Work Phone []:
        Home Phone []:
        Other []:
Is the information correct? [Y/n] y
```
### 4.3 Probar el comportamiento sin el sticky bit
Primero creamos un archivo con el primer usuario
```bash
hgs1@hugo:/$ cd compartido/
hgs1@hugo:/compartido$ touch fichero
```
ahora con el segundo usuario intentamos borrarlo
```bash
usuario@hugo:/$ su hgs2
Password:
hgs2@hugo:/$ cd compartido/
hgs2@hugo:/compartido$ rm fichero
rm: remove write-protected regular empty file 'fichero'? y
hgs2@hugo:/compartido$ ls
```
### 4.4 Establecer el sticky bit en el directorio
```bash
usuario@hugo:/$ sudo chmod +t /compartido/
usuario@hugo:/$ ls -ld compartido
drwxrwxrwt 2 root root 4096 Oct  8 07:03 compartido
```
### 4.5 Probar el comportamiento con el sticky bit
```bash
usuario@hugo:/$ su hgs1
Password:
hgs1@hugo:/$ cd compartido/
hgs1@hugo:/compartido$ touch fichero
hgs1@hugo:/compartido$ echo hola > "fichero" 
hgs1@hugo:/compartido$ cat fichero
hola
hgs1@hugo:/compartido$ exit
usuario@hugo:/$ su hgs2
Password:
hgs2@hugo:/$ cd compartido
hgs2@hugo:/compartido$ rm fichero 
rm: remove write-protected regular file 'fichero'? y
rm: cannot remove 'fichero': Operation not permitted
```
### 4.6 Preguntas
#### ¿Qué efecto tiene el sticky bit en un directorio?
 El sticky bit impide que los usuarios borren archivos de otros, incluso si tienen permisos para escribir en el directorio. Solo el dueño del archivo, el dueño del directorio o el administrador (root) pueden borrar archivos
#### Si tienes habilitado el sticky bit, ¿cómo tendrías que hacer para eliminar un fichero dentro del directorio?
- Eres el dueño del archivo.
- Eres el dueño del directorio.
- O tienes permisos de administrador (root).